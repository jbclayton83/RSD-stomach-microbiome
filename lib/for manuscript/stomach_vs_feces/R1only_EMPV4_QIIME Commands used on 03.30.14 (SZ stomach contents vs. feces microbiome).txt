R1 only: EMPV4 QIIME Commands used on 03.30.14 (SZ stomach contents vs. feces microbiome)

EMPV4 (R1 only):

Comparisons between datasets (No_Chloroplasts):
*The following comparisons are being made:
1. EMPV4_R1only_SZ_douc_stomach_contents and EMPV4_R1only_SZ_douc_feces (One_sample_per_individual_matching_subjects_with_fecal_samples)(SZ_RSD_stomach_contents_vs_feces_comparison):


I. Filter OTUs from OTU table:
*Note: Using filter_samples_from_otu_table.py to remove the following samples from the SZ stomach contents microbiome dataset: SZ.SC3.

filter_samples_from_otu_table.py -i seqs_EMPV4_R1only_SZ_doucs_stomach_contents_microbiome_metadata_otus_NO_CHLOROPLASTS.biom -o seqs_EMPV4_R1only_SZ_doucs_stomach_contents_microbiome_metadata_otus_NO_CHLOROPLASTS_filtered.biom --sample_id_fp JBC_EMPV4_SZ_stomach_contents_No_SZ.SC3_sampleIDs.txt



II. Filter OTUs from OTU table:
*Note: Using filter_samples_from_otu_table.py to remove the following samples from the SZ feces microbiome dataset: SZ.MB1-4, SZ.MB8, SZ.MB11, and SZ.MB13-15.

filter_samples_from_otu_table.py -i seqs_EMPV4_R1only_otus_metadata_NO_CHLOROPLASTS_Pygathrix_nemaeus_Singapore_Zoo_feces.biom -o seqs_EMPV4_R1only_otus_metadata_NO_CHLOROPLASTS_Pygathrix_nemaeus_Singapore_Zoo_feces_filtered.biom --sample_id_fp JBC_EMPV4_SZ_feces_No_SZ.MB1-4,SZ.MB8,SZ.MB11,SZ.MB13-15_sampleIDs.txt



III. Merge Mapping Files (merge two mapping files into a new mapping file):
merge_mapping_files.py -m EMPV4_singapore_zoo_douc_stomach_contents_mapfile_031315_samples_matching_subjects_with_fecal_samples.txt,EMPV4_singapore_zoo_douc_feces_mapfile_031315_samples_matching_subjects_with_stomach_contents_samples.txt -o jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -n 'Data not collected'



IV. Merge OTU tables (Merge two OTU tables into a single OTU table):
merge_otu_tables.py -i seqs_EMPV4_R1only_SZ_doucs_stomach_contents_microbiome_metadata_otus_NO_CHLOROPLASTS_filtered.biom,seqs_EMPV4_R1only_otus_metadata_NO_CHLOROPLASTS_Pygathrix_nemaeus_Singapore_Zoo_feces_filtered.biom -o SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.biom



V. Making OTU biom table:

1. biom summarize-table -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.biom -o otu_summary_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.txt

2. Make OTU table from biom format to .txt:
biom convert -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.biom -o otu_biom_table_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.txt --to-tsv



VI. Compute Core Microbiome: 

1. compute_core_microbiome.py -i seqs_EMPV4_R1only_SZ_doucs_stomach_contents_microbiome_metadata_otus_NO_CHLOROPLASTS_filtered.biom -o otu_table_core_seqs_EMPV4_R1only_SZ_doucs_stomach_contents_microbiome_metadata_otus_NO_CHLOROPLASTS_filtered

2. compute_core_microbiome.py -i seqs_EMPV4_R1only_otus_metadata_NO_CHLOROPLASTS_Pygathrix_nemaeus_Singapore_Zoo_feces_filtered.biom -o otu_table_core_seqs_EMPV4_R1only_otus_metadata_NO_CHLOROPLASTS_Pygathrix_nemaeus_Singapore_Zoo_feces_filtered



VII. Alpha Diversity:

1. This following command is needed, as the alpha_params.txt file needs to be created manually: echo "alpha_diversity:metrics shannon,PD_whole_tree,chao1,observed_species" > alpha_params.txt

alpha_rarefaction.py -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.biom -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -o wf_arare_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS/ -p alpha_params.txt -t /panfs/roc/groups/8/knightsd/public/gg_13_8_otus/trees/97_otus.tree



VIII. Beta Diversity:

beta_diversity_through_plots.py -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.biom -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -t /panfs/roc/groups/8/knightsd/public/gg_13_8_otus/trees/97_otus.tree -e 24000 -o wf_bdiv_even146_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS/



IX. Taxa Summary:

1. summarize_taxa_through_plots.py -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.biom -o taxa_summary_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_#SampleID

2. summarize_taxa_through_plots.py -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.biom -o taxa_summary_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_AnimalID_name -c AnimalID_name

3. summarize_taxa_through_plots.py -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.biom -o taxa_summary_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_Sex -c Sex

4. summarize_taxa_through_plots.py -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.biom -o taxa_summary_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_AgeClass -c AgeClass

5. summarize_taxa_through_plots.py -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.biom -o taxa_summary_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_Alive_or_Deceased_as_of_091814 -c Alive_or_Deceased_as_of_091814

6. summarize_taxa_through_plots.py -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.biom -o taxa_summary_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_Bodysite -c Bodysite



X. Species Gradient Coloring via R statistical package (Unifrac Distance Matrix):
*Based on Dan Knightsâ€™s suggestion, the commands ran here did specify a particular unifrac file (-d), therefore the same distance matrix was used and therefore the output generates the same plots for each taxonomy level (L2-L6). In other words, the commands include a -d, thus providing the same distance matrix for taxonomy levels, which matches the distance matrixes generated in the original beta diversity plots. Plots for all taxonomic levels for both douc and howler sample sets generated.
**Note: The MWAS package has been updated, which resulted in a change in the species gradient coloring command (as well as other commands). These changes are reflected below.

Unweighted:
1. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L2.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -o L2_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_gradients_NO_CHLOROPLASTS
2. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L3.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -o L3_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_gradients_NO_CHLOROPLASTS
3. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L4.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -o L4_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_gradients_NO_CHLOROPLASTS
4. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L5.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -o L5_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_gradients_NO_CHLOROPLASTS
5. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -o L6_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_gradients_NO_CHLOROPLASTS

Weighted: 
1. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L2.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_unifrac_dm_NO_CHLOROPLASTS.txt -o L2_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_gradients_NO_CHLOROPLASTS
2. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L3.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_unifrac_dm_NO_CHLOROPLASTS.txt -o L3_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_gradients_NO_CHLOROPLASTS
3. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L4.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_unifrac_dm_NO_CHLOROPLASTS.txt -o L4_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_gradients_NO_CHLOROPLASTS
4. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L5.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_unifrac_dm_NO_CHLOROPLASTS.txt -o L5_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_gradients_NO_CHLOROPLASTS
5. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_unifrac_dm_NO_CHLOROPLASTS.txt -o L6_jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_gradients_NO_CHLOROPLASTS



XI. Beta Diversity Plot (2D) via R statistical package (Unifrac Distance Matrix):
*Note: The MWAS package has been updated, which resulted in a change in the beta diversity plot (2D) command (as well as other commands). These changes are reflected below.

Unweighted:
1. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c AnimalID_name -o L6_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_EMPV4_R1only_NO_CHLOROPLASTS_gradients_unifrac_unweighted_PCoA_AnimalID_name

2. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c Sex -o L6_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_EMPV4_R1only_NO_CHLOROPLASTS_gradients_unifrac_unweighted_PCoA_Sex

3. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c AgeClass -o L6_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_EMPV4_R1only_NO_CHLOROPLASTS_gradients_unifrac_unweighted_PCoA_AgeClass

4. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c Alive_or_Deceased_as_of_091814 -o L6_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_EMPV4_R1only_NO_CHLOROPLASTS_gradients_unifrac_unweighted_PCoA_Alive_or_Deceased_as_of_091814

5. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c Bodysite -o L6_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_EMPV4_R1only_NO_CHLOROPLASTS_gradients_unifrac_unweighted_PCoA_Bodysite

Weighted:
1. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c AnimalID_name -o L6_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_EMPV4_R1only_NO_CHLOROPLASTS_gradients_unifrac_weighted_PCoA_AnimalID_name

2. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c Sex -o L6_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_EMPV4_R1only_NO_CHLOROPLASTS_gradients_unifrac_weighted_PCoA_Sex

3. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c AgeClass -o L6_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_EMPV4_R1only_NO_CHLOROPLASTS_gradients_unifrac_weighted_PCoA_AgeClass

4. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c Alive_or_Deceased_as_of_091814 -o L6_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_EMPV4_R1only_NO_CHLOROPLASTS_gradients_unifrac_weighted_PCoA_Alive_or_Deceased_as_of_091814

5. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M gradients -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -D jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_weighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c Bodysite -o L6_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_EMPV4_R1only_NO_CHLOROPLASTS_gradients_unifrac_weighted_PCoA_Bodysite



XII. Beeswarm Plots via R statistical package:
*Note: The MWAS package has been updated, which resulted in a change in the beeswarm command (as well as other commands). These changes are reflected below.
**Note: When the following message is generated after running the command this means that there are not any statistically significant differences at the FDR chosen: Failed to find any features. There is no feature under the chosen FDR control. In this case, you can adjust the -A to a less stringent value or report that via this method (i.e., beeswarm plots) there were no statistically significant differences at the chosen FDR.
***Note: For the commands below, AnimalID_name, Sex, AgeClass, and Alive_or_Deceased_as_of_091814 were not significant at FDR 0.05.

1. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M beeswarm -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c AnimalID_name -o EMPV4_R1only_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_merged_otu_table_comparison_NO_CHLOROPLASTS_beeswarm_AnimalID_name -A 0.05

2. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M beeswarm -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c Sex -o EMPV4_R1only_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_merged_otu_table_comparison_NO_CHLOROPLASTS_beeswarm_Sex -A 0.05

3. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M beeswarm -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c AgeClass -o EMPV4_R1only_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_merged_otu_table_comparison_NO_CHLOROPLASTS_beeswarm_AgeClass -A 0.05

4. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M beeswarm -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c Alive_or_Deceased_as_of_091814 -o EMPV4_R1only_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_merged_otu_table_comparison_NO_CHLOROPLASTS_beeswarm_Alive_or_Deceased_as_of_091814 -A 0.05

5. Rscript $MWAS_DIR/bin/mwas_analysis.R -w plot -M beeswarm -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_L6.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c Bodysite -o EMPV4_R1only_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_merged_otu_table_comparison_NO_CHLOROPLASTS_beeswarm_Bodysite -A 0.05



XIII. Compute Taxonomy Ratios
*Note: Using the following command to compute the Firmicutes to Bacteroidetes ratio for each primate species.

All samples by #SampleID (this category includes all samples in this study):
compute_taxonomy_ratios.py -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS.biom --increased p__Firmicutes --decreased p__Bacteroidetes -o jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_NO_CHLOROPLASTS_firmicutes_to_bacteroidetes_ratio.txt



XIV. Statistical Testing (compare_categories.py):

ANOSIM:
By Bodysite:
99 permutations:
compare_categories.py --method anosim -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c Bodysite -o anosim_99_out_EMPV4_R1only_SZ_doucs_stomach_contents_microbiome_metadata_otus_unweighted_unifrac_dm_NO_CHLOROPLASTS_Bodysite -n 99

999 permutations:
compare_categories.py --method anosim -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c Bodysite -o anosim_999_out_EMPV4_R1only_SZ_doucs_stomach_contents_microbiome_metadata_otus_unweighted_unifrac_dm_NO_CHLOROPLASTS_Bodysite -n 999


PERMANOVA:
By Bodysite:
999 permutations:
compare_categories.py --method permanova -i jbcempv4_SZ_RSD_stomach_contents_filtered_vs_SZ_RSD_feces_filtered_comparison_merged_otu_table_unweighted_unifrac_dm_NO_CHLOROPLASTS.txt -m jbcempv4_SZ_RSD_stomach_contents_vs_feces_comparison_merged_mapping.txt -c Bodysite -o permanova_999_out_EMPV4_R1only_SZ_doucs_stomach_contents_microbiome_metadata_otus_unweighted_unifrac_dm_NO_CHLOROPLASTS_Bodysite -n 999